name: PHP on x86_64

on:
  push:
    paths:
      - 'php+cli/**'
      - 'php+apache/**'
      - 'php+nginx/**'
      - 'php-core/**'
      - 'marshall/**'
      - 'Dockerfile'
      - '.dockerignore'
      - '.github/workflows/build-x86_64-marshall.yml'
      - '.github/workflows/build-x86_64-php.yml'
      - '.github/workflows/lint-dockerfiles.yml'
  schedule:
    - cron: '0 5 * * TUE'

jobs:
  PHP_APACHE_56:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:apache-5.6         --target=php-apache         --build-arg "PHP_VERSION=5.6" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_56" .
          docker build -t gone/php:apache-5.6-onbuild --target=php-apache-onbuild --build-arg "PHP_VERSION=5.6" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_56" .
        env:
          PHP_PACKAGES_56: git mariadb-client php-cli php-redis php-apcu php-xdebug php5.6-bcmath php5.6-bz2 php5.6-cli php5.6-curl php5.6-gd php5.6-imap php5.6-imagick php5.6-intl php5.6-json php5.6-ldap php5.6-mbstring php5.6-mcrypt php5.6-memcache php5.6-memcached php5.6-mysql php5.6-opcache php5.6-pgsql php5.6-phpdbg php5.6-pspell php5.6-redis php5.6-soap php5.6-sqlite php5.6-xml php5.6-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:apache-5.6         docker.pkg.github.com/goneio/base-image/php:apache-5.6
          docker tag gone/php:apache-5.6-onbuild docker.pkg.github.com/goneio/base-image/php:apache-5.6-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:apache-5.6
          docker push gone/php:apache-5.6-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:apache-5.6
          docker push docker.pkg.github.com/goneio/base-image/php:apache-5.6-onbuild
  PHP_APACHE_70:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:apache-7.0         --target=php-apache         --build-arg "PHP_VERSION=7.0" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_70" .
          docker build -t gone/php:apache-7.0-onbuild --target=php-apache-onbuild --build-arg "PHP_VERSION=7.0" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_70" .
        env:
          PHP_PACKAGES_70: git mariadb-client php-cli php-redis php-apcu php-xdebug php7.0-bcmath php7.0-bz2 php7.0-cli php7.0-curl php7.0-gd php7.0-imap php7.0-imagick php7.0-intl php7.0-json php7.0-ldap php7.0-mbstring php7.0-mcrypt php7.0-memcache php7.0-memcached php7.0-mongodb php7.0-mysql php7.0-opcache php7.0-pgsql php7.0-phpdbg php7.0-pspell php7.0-redis php7.0-soap php7.0-sqlite php7.0-xml php7.0-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:apache-7.0         docker.pkg.github.com/goneio/base-image/php:apache-7.0
          docker tag gone/php:apache-7.0-onbuild docker.pkg.github.com/goneio/base-image/php:apache-7.0-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:apache-7.0
          docker push gone/php:apache-7.0-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:apache-7.0
          docker push docker.pkg.github.com/goneio/base-image/php:apache-7.0-onbuild
  PHP_APACHE_71:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:apache-7.1         --target=php-apache         --build-arg "PHP_VERSION=7.1" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_71" .
          docker build -t gone/php:apache-7.1-onbuild --target=php-apache-onbuild --build-arg "PHP_VERSION=7.1" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_71" .
        env:
          PHP_PACKAGES_71: git mariadb-client php-cli php-redis php-apcu php-xdebug php7.1-bcmath php7.1-bz2 php7.1-cli php7.1-curl php7.1-db php7.1-gd php7.1-imap php7.1-imagick php7.1-intl php7.1-json php7.1-ldap php7.1-mbstring php7.1-mcrypt php7.1-memcache php7.1-memcached php7.1-mongodb php7.1-mysql php7.1-opcache php7.1-pgsql php7.1-phpdbg php7.1-pspell php7.1-redis php7.1-soap php7.1-sqlite php7.1-xml php7.1-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:apache-7.1         docker.pkg.github.com/goneio/base-image/php:apache-7.1
          docker tag gone/php:apache-7.1-onbuild docker.pkg.github.com/goneio/base-image/php:apache-7.1-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:apache-7.1
          docker push gone/php:apache-7.1-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:apache-7.1
          docker push docker.pkg.github.com/goneio/base-image/php:apache-7.1-onbuild
  PHP_APACHE_72:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:apache-7.2         --target=php-apache         --build-arg "PHP_VERSION=7.2" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_72" .
          docker build -t gone/php:apache-7.2-onbuild --target=php-apache-onbuild --build-arg "PHP_VERSION=7.2" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_72" .
        env:
          PHP_PACKAGES_72: git mariadb-client php-cli php-redis php-apcu php-xdebug php7.2-bcmath php7.2-bz2 php7.2-cli php7.2-curl php7.2-gd php7.2-imap php7.2-imagick php7.2-intl php7.2-json php7.2-ldap php7.2-mbstring php7.2-memcache php7.2-memcached php7.2-mongodb php7.2-mysql php7.2-opcache php7.2-pgsql php7.2-phpdbg php7.2-pspell php7.2-redis php7.2-soap php7.2-sqlite php7.2-xml php7.2-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:apache-7.2         docker.pkg.github.com/goneio/base-image/php:apache-7.2
          docker tag gone/php:apache-7.2-onbuild docker.pkg.github.com/goneio/base-image/php:apache-7.2-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:apache-7.2
          docker push gone/php:apache-7.2-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:apache-7.2
          docker push docker.pkg.github.com/goneio/base-image/php:apache-7.2-onbuild
  PHP_APACHE_73:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:apache-7.3         --target=php-apache         --build-arg "PHP_VERSION=7.3" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_73" .
          docker build -t gone/php:apache-7.3-onbuild --target=php-apache-onbuild --build-arg "PHP_VERSION=7.3" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_73" .
        env:
          PHP_PACKAGES_73: git mariadb-client php-cli php-redis php-apcu php-xdebug php7.3-bcmath php7.3-bz2 php7.3-cli php7.3-curl php7.3-gd php7.3-imap php7.3-imagick php7.3-intl php7.3-json php7.3-ldap php7.3-mbstring php7.3-memcache php7.3-memcached php7.3-mongodb php7.3-mysql php7.3-opcache php7.3-pgsql php7.3-phpdbg php7.3-pspell php7.3-redis php7.3-soap php7.3-sqlite php7.3-xml php7.3-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:apache-7.3         docker.pkg.github.com/goneio/base-image/php:apache-7.3
          docker tag gone/php:apache-7.3-onbuild docker.pkg.github.com/goneio/base-image/php:apache-7.3-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:apache-7.3
          docker push gone/php:apache-7.3-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:apache-7.3
          docker push docker.pkg.github.com/goneio/base-image/php:apache-7.3-onbuild
  PHP_APACHE_74:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:apache-7.4         --target=php-apache         --build-arg "PHP_VERSION=7.4" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_74" .
          docker build -t gone/php:apache-7.4-onbuild --target=php-apache-onbuild --build-arg "PHP_VERSION=7.4" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_74" .
        env:
          PHP_PACKAGES_74: git mariadb-client php-cli php-redis php-apcu php-xdebug php7.4-bcmath php7.4-bz2 php7.4-cli php7.4-curl php7.4-gd php7.4-imap php7.4-imagick php7.4-intl php7.4-json php7.4-ldap php7.4-mbstring php7.4-memcache php7.4-mongodb php7.4-mysql php7.4-opcache php7.4-pgsql php7.4-phpdbg php7.4-pspell php7.4-soap php7.4-sqlite php7.4-xml php7.4-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:apache-7.4         docker.pkg.github.com/goneio/base-image/php:apache-7.4
          docker tag gone/php:apache-7.4-onbuild docker.pkg.github.com/goneio/base-image/php:apache-7.4-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:apache-7.4
          docker push gone/php:apache-7.4-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:apache-7.4
          docker push docker.pkg.github.com/goneio/base-image/php:apache-7.4-onbuild
  PHP_APACHE_80:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:apache-8.0         --target=php-apache         --build-arg "PHP_VERSION=8.0" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_80" .
          docker build -t gone/php:apache-8.0-onbuild --target=php-apache-onbuild --build-arg "PHP_VERSION=8.0" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_80" .
        env:
          PHP_PACKAGES_80: git mariadb-client php-cli php-redis php-apcu php-xdebug php8.0-bcmath php8.0-bz2 php8.0-cli php8.0-curl php8.0-gd php8.0-imap php8.0-imagick php8.0-intl php8.0-ldap php8.0-mbstring php8.0-memcache  php8.0-mysql php8.0-opcache php8.0-pgsql php8.0-phpdbg php8.0-pspell php8.0-soap php8.0-sqlite php8.0-xml php8.0-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:apache-8.0         docker.pkg.github.com/goneio/base-image/php:apache-8.0
          docker tag gone/php:apache-8.0-onbuild docker.pkg.github.com/goneio/base-image/php:apache-8.0-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:apache-8.0
          docker push gone/php:apache-8.0-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:apache-8.0
          docker push docker.pkg.github.com/goneio/base-image/php:apache-8.0-onbuild

  PHP_NGINX_56:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:nginx-5.6         --target=php-nginx         --build-arg "PHP_VERSION=5.6" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_56" .
          docker build -t gone/php:nginx-5.6-onbuild --target=php-nginx-onbuild --build-arg "PHP_VERSION=5.6" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_56" .
        env:
          PHP_PACKAGES_56: git mariadb-client php-redis php-apcu php-xdebug php5.6-bcmath php5.6-bz2 php5.6-cli php5.6-curl php5.6-gd php5.6-imap php5.6-imagick php5.6-intl php5.6-json php5.6-ldap php5.6-mbstring php5.6-mcrypt php5.6-memcache php5.6-memcached php5.6-mysql php5.6-opcache php5.6-pgsql php5.6-phpdbg php5.6-pspell php5.6-redis php5.6-soap php5.6-sqlite php5.6-xml php5.6-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:nginx-5.6         docker.pkg.github.com/goneio/base-image/php:nginx-5.6
          docker tag gone/php:nginx-5.6-onbuild docker.pkg.github.com/goneio/base-image/php:nginx-5.6-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:nginx-5.6
          docker push gone/php:nginx-5.6-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:nginx-5.6
          docker push docker.pkg.github.com/goneio/base-image/php:nginx-5.6-onbuild
  PHP_NGINX_70:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:nginx-7.0         --target=php-nginx         --build-arg "PHP_VERSION=7.0" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_70" .
          docker build -t gone/php:nginx-7.0-onbuild --target=php-nginx-onbuild --build-arg "PHP_VERSION=7.0" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_70" .
        env:
          PHP_PACKAGES_70: git mariadb-client php-redis php-apcu php-xdebug php7.0-bcmath php7.0-bz2 php7.0-cli php7.0-curl php7.0-gd php7.0-imap php7.0-imagick php7.0-intl php7.0-json php7.0-ldap php7.0-mbstring php7.0-mcrypt php7.0-memcache php7.0-memcached php7.0-mongodb php7.0-mysql php7.0-opcache php7.0-pgsql php7.0-phpdbg php7.0-pspell php7.0-redis php7.0-soap php7.0-sqlite php7.0-xml php7.0-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:nginx-7.0         docker.pkg.github.com/goneio/base-image/php:nginx-7.0
          docker tag gone/php:nginx-7.0-onbuild docker.pkg.github.com/goneio/base-image/php:nginx-7.0-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:nginx-7.0
          docker push gone/php:nginx-7.0-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:nginx-7.0
          docker push docker.pkg.github.com/goneio/base-image/php:nginx-7.0-onbuild
  PHP_NGINX_71:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:nginx-7.1         --target=php-nginx         --build-arg "PHP_VERSION=7.1" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_71" .
          docker build -t gone/php:nginx-7.1-onbuild --target=php-nginx-onbuild --build-arg "PHP_VERSION=7.1" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_71" .
        env:
          PHP_PACKAGES_71: git mariadb-client php-redis php-apcu php-xdebug php7.1-bcmath php7.1-bz2 php7.1-cli php7.1-curl php7.1-db php7.1-gd php7.1-imap php7.1-imagick php7.1-intl php7.1-json php7.1-ldap php7.1-mbstring php7.1-mcrypt php7.1-memcache php7.1-memcached php7.1-mongodb php7.1-mysql php7.1-opcache php7.1-pgsql php7.1-phpdbg php7.1-pspell php7.1-redis php7.1-soap php7.1-sqlite php7.1-xml php7.1-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:nginx-7.1         docker.pkg.github.com/goneio/base-image/php:nginx-7.1
          docker tag gone/php:nginx-7.1-onbuild docker.pkg.github.com/goneio/base-image/php:nginx-7.1-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:nginx-7.1
          docker push gone/php:nginx-7.1-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:nginx-7.1
          docker push docker.pkg.github.com/goneio/base-image/php:nginx-7.1-onbuild
  PHP_NGINX_72:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:nginx-7.2         --target=php-nginx         --build-arg "PHP_VERSION=7.2" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_72" .
          docker build -t gone/php:nginx-7.2-onbuild --target=php-nginx-onbuild --build-arg "PHP_VERSION=7.2" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_72" .
        env:
          PHP_PACKAGES_72: git mariadb-client php-redis php-apcu php-xdebug php7.2-bcmath php7.2-bz2 php7.2-cli php7.2-curl php7.2-gd php7.2-imap php7.2-imagick php7.2-intl php7.2-json php7.2-ldap php7.2-mbstring php7.2-memcache php7.2-memcached php7.2-mongodb php7.2-mysql php7.2-opcache php7.2-pgsql php7.2-phpdbg php7.2-pspell php7.2-redis php7.2-soap php7.2-sqlite php7.2-xml php7.2-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:nginx-7.2         docker.pkg.github.com/goneio/base-image/php:nginx-7.2
          docker tag gone/php:nginx-7.2-onbuild docker.pkg.github.com/goneio/base-image/php:nginx-7.2-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:nginx-7.2
          docker push gone/php:nginx-7.2-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:nginx-7.2
          docker push docker.pkg.github.com/goneio/base-image/php:nginx-7.2-onbuild
  PHP_NGINX_73:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:nginx-7.3         --target=php-nginx         --build-arg "PHP_VERSION=7.3" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_73" .
          docker build -t gone/php:nginx-7.3-onbuild --target=php-nginx-onbuild --build-arg "PHP_VERSION=7.3" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_73" .
        env:
          PHP_PACKAGES_73: git mariadb-client php-redis php-apcu php-xdebug php7.3-bcmath php7.3-bz2 php7.3-cli php7.3-curl php7.3-gd php7.3-imap php7.3-imagick php7.3-intl php7.3-json php7.3-ldap php7.3-mbstring php7.3-memcache php7.3-memcached php7.3-mongodb php7.3-mysql php7.3-opcache php7.3-pgsql php7.3-phpdbg php7.3-pspell php7.3-redis php7.3-soap php7.3-sqlite php7.3-xml php7.3-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:nginx-7.3         docker.pkg.github.com/goneio/base-image/php:nginx-7.3
          docker tag gone/php:nginx-7.3-onbuild docker.pkg.github.com/goneio/base-image/php:nginx-7.3-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:nginx-7.3
          docker push gone/php:nginx-7.3-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:nginx-7.3
          docker push docker.pkg.github.com/goneio/base-image/php:nginx-7.3-onbuild
  PHP_NGINX_74:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:nginx-7.4         --target=php-nginx         --build-arg "PHP_VERSION=7.4" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_74" .
          docker build -t gone/php:nginx-7.4-onbuild --target=php-nginx-onbuild --build-arg "PHP_VERSION=7.4" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_74" .
        env:
          PHP_PACKAGES_74: git mariadb-client php-redis php-apcu php-xdebug php7.4-bcmath php7.4-bz2 php7.4-cli php7.4-curl php7.4-gd php7.4-imap php7.4-imagick php7.4-intl php7.4-json php7.4-ldap php7.4-mbstring php7.4-memcache php7.4-mongodb php7.4-mysql php7.4-opcache php7.4-pgsql php7.4-phpdbg php7.4-pspell php7.4-soap php7.4-sqlite php7.4-xml php7.4-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:nginx-7.4         docker.pkg.github.com/goneio/base-image/php:nginx-7.4
          docker tag gone/php:nginx-7.4-onbuild docker.pkg.github.com/goneio/base-image/php:nginx-7.4-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:nginx-7.4
          docker push gone/php:nginx-7.4-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:nginx-7.4
          docker push docker.pkg.github.com/goneio/base-image/php:nginx-7.4-onbuild
  PHP_NGINX_80:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:nginx-8.0         --target=php-nginx         --build-arg "PHP_VERSION=8.0" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_80" .
          docker build -t gone/php:nginx-8.0-onbuild --target=php-nginx-onbuild --build-arg "PHP_VERSION=8.0" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_80" .
        env:
          PHP_PACKAGES_80: git mariadb-client php-redis php-apcu php-xdebug php8.0-bcmath php8.0-bz2 php8.0-cli php8.0-curl php8.0-gd php8.0-imap php8.0-imagick php8.0-intl php8.0-ldap php8.0-mbstring php8.0-memcache  php8.0-mysql php8.0-opcache php8.0-pgsql php8.0-phpdbg php8.0-pspell php8.0-soap php8.0-sqlite php8.0-xml php8.0-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:nginx-8.0         docker.pkg.github.com/goneio/base-image/php:nginx-8.0
          docker tag gone/php:nginx-8.0-onbuild docker.pkg.github.com/goneio/base-image/php:nginx-8.0-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:nginx-8.0
          docker push gone/php:nginx-8.0-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:nginx-8.0
          docker push docker.pkg.github.com/goneio/base-image/php:nginx-8.0-onbuild
          
  PHP_CLI_56:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:cli-5.6         --target=php-cli         --build-arg "PHP_VERSION=5.6" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_56" .
          docker build -t gone/php:cli-5.6-onbuild --target=php-cli-onbuild --build-arg "PHP_VERSION=5.6" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_56" .
        env:
          PHP_PACKAGES_56: git mariadb-client php-redis php-apcu php-xdebug php5.6-bcmath php5.6-bz2 php5.6-cli php5.6-curl php5.6-gd php5.6-imap php5.6-imagick php5.6-intl php5.6-json php5.6-ldap php5.6-mbstring php5.6-mcrypt php5.6-memcache php5.6-memcached php5.6-mysql php5.6-opcache php5.6-pgsql php5.6-phpdbg php5.6-pspell php5.6-redis php5.6-soap php5.6-sqlite php5.6-xml php5.6-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:cli-5.6         docker.pkg.github.com/goneio/base-image/php:cli-5.6
          docker tag gone/php:cli-5.6-onbuild docker.pkg.github.com/goneio/base-image/php:cli-5.6-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:cli-5.6
          docker push gone/php:cli-5.6-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:cli-5.6
          docker push docker.pkg.github.com/goneio/base-image/php:cli-5.6-onbuild
  PHP_CLI_70:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:cli-7.0         --target=php-cli         --build-arg "PHP_VERSION=7.0" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_70" .
          docker build -t gone/php:cli-7.0-onbuild --target=php-cli-onbuild --build-arg "PHP_VERSION=7.0" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_70" .
        env:
          PHP_PACKAGES_70: git mariadb-client php-redis php-apcu php-xdebug php7.0-bcmath php7.0-bz2 php7.0-cli php7.0-curl php7.0-gd php7.0-imap php7.0-imagick php7.0-intl php7.0-json php7.0-ldap php7.0-mbstring php7.0-mcrypt php7.0-memcache php7.0-memcached php7.0-mongodb php7.0-mysql php7.0-opcache php7.0-pgsql php7.0-phpdbg php7.0-pspell php7.0-redis php7.0-soap php7.0-sqlite php7.0-xml php7.0-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:cli-7.0         docker.pkg.github.com/goneio/base-image/php:cli-7.0
          docker tag gone/php:cli-7.0-onbuild docker.pkg.github.com/goneio/base-image/php:cli-7.0-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:cli-7.0
          docker push gone/php:cli-7.0-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:cli-7.0
          docker push docker.pkg.github.com/goneio/base-image/php:cli-7.0-onbuild
  PHP_CLI_71:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:cli-7.1         --target=php-cli         --build-arg "PHP_VERSION=7.1" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_71" .
          docker build -t gone/php:cli-7.1-onbuild --target=php-cli-onbuild --build-arg "PHP_VERSION=7.1" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_71" .
        env:
          PHP_PACKAGES_71: git mariadb-client php-redis php-apcu php-xdebug php7.1-bcmath php7.1-bz2 php7.1-cli php7.1-curl php7.1-db php7.1-gd php7.1-imap php7.1-imagick php7.1-intl php7.1-json php7.1-ldap php7.1-mbstring php7.1-mcrypt php7.1-memcache php7.1-memcached php7.1-mongodb php7.1-mysql php7.1-opcache php7.1-pgsql php7.1-phpdbg php7.1-pspell php7.1-redis php7.1-soap php7.1-sqlite php7.1-xml php7.1-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:cli-7.1         docker.pkg.github.com/goneio/base-image/php:cli-7.1
          docker tag gone/php:cli-7.1-onbuild docker.pkg.github.com/goneio/base-image/php:cli-7.1-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:cli-7.1
          docker push gone/php:cli-7.1-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:cli-7.1
          docker push docker.pkg.github.com/goneio/base-image/php:cli-7.1-onbuild
  PHP_CLI_72:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:cli-7.2         --target=php-cli         --build-arg "PHP_VERSION=7.2" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_72" .
          docker build -t gone/php:cli-7.2-onbuild --target=php-cli-onbuild --build-arg "PHP_VERSION=7.2" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_72" .
        env:
          PHP_PACKAGES_72: git mariadb-client php-redis php-apcu php-xdebug php7.2-bcmath php7.2-bz2 php7.2-cli php7.2-curl php7.2-gd php7.2-imap php7.2-imagick php7.2-intl php7.2-json php7.2-ldap php7.2-mbstring php7.2-memcache php7.2-memcached php7.2-mongodb php7.2-mysql php7.2-opcache php7.2-pgsql php7.2-phpdbg php7.2-pspell php7.2-redis php7.2-soap php7.2-sqlite php7.2-xml php7.2-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:cli-7.2         docker.pkg.github.com/goneio/base-image/php:cli-7.2
          docker tag gone/php:cli-7.2-onbuild docker.pkg.github.com/goneio/base-image/php:cli-7.2-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:cli-7.2
          docker push gone/php:cli-7.2-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:cli-7.2
          docker push docker.pkg.github.com/goneio/base-image/php:cli-7.2-onbuild
  PHP_CLI_73:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:cli-7.3         --target=php-cli         --build-arg "PHP_VERSION=7.3" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_73" .
          docker build -t gone/php:cli-7.3-onbuild --target=php-cli-onbuild --build-arg "PHP_VERSION=7.3" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_73" .
        env:
          PHP_PACKAGES_73: git mariadb-client php-redis php-apcu php-xdebug php7.3-bcmath php7.3-bz2 php7.3-cli php7.3-curl php7.3-gd php7.3-imap php7.3-imagick php7.3-intl php7.3-json php7.3-ldap php7.3-mbstring php7.3-memcache php7.3-memcached php7.3-mongodb php7.3-mysql php7.3-opcache php7.3-pgsql php7.3-phpdbg php7.3-pspell php7.3-redis php7.3-soap php7.3-sqlite php7.3-xml php7.3-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:cli-7.3         docker.pkg.github.com/goneio/base-image/php:cli-7.3
          docker tag gone/php:cli-7.3-onbuild docker.pkg.github.com/goneio/base-image/php:cli-7.3-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:cli-7.3
          docker push gone/php:cli-7.3-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:cli-7.3
          docker push docker.pkg.github.com/goneio/base-image/php:cli-7.3-onbuild
  PHP_CLI_74:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:cli-7.4         --target=php-cli         --build-arg "PHP_VERSION=7.4" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_74" .
          docker build -t gone/php:cli-7.4-onbuild --target=php-cli-onbuild --build-arg "PHP_VERSION=7.4" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_74" .
        env:
          PHP_PACKAGES_74: git mariadb-client php-redis php-apcu php-xdebug php7.4-bcmath php7.4-bz2 php7.4-cli php7.4-curl php7.4-gd php7.4-imap php7.4-imagick php7.4-intl php7.4-json php7.4-ldap php7.4-mbstring php7.4-memcache php7.4-mongodb php7.4-mysql php7.4-opcache php7.4-pgsql php7.4-phpdbg php7.4-pspell php7.4-soap php7.4-sqlite php7.4-xml php7.4-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:cli-7.4         docker.pkg.github.com/goneio/base-image/php:cli-7.4
          docker tag gone/php:cli-7.4-onbuild docker.pkg.github.com/goneio/base-image/php:cli-7.4-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:cli-7.4
          docker push gone/php:cli-7.4-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:cli-7.4
          docker push docker.pkg.github.com/goneio/base-image/php:cli-7.4-onbuild
  PHP_CLI_80:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Setup
        run: |
          git rev-parse --short HEAD > marshall/marshall_version
          date '+%Y-%m-%d %H:%M:%S' > marshall/marshall_build_date
          hostname > marshall/marshall_build_host
      - name: Build Image
        run: |
          docker build -t gone/php:cli-8.0         --target=php-cli         --build-arg "PHP_VERSION=8.0" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_80" .
          docker build -t gone/php:cli-8.0-onbuild --target=php-cli-onbuild --build-arg "PHP_VERSION=8.0" --build-arg "PHP_PACKAGES=$PHP_PACKAGES_80" .
        env:
          PHP_PACKAGES_80: git mariadb-client php-redis php-apcu php-xdebug php8.0-bcmath php8.0-bz2 php8.0-cli php8.0-curl php8.0-gd php8.0-imap php8.0-imagick php8.0-intl php8.0-ldap php8.0-mbstring php8.0-memcache  php8.0-mysql php8.0-opcache php8.0-pgsql php8.0-phpdbg php8.0-pspell php8.0-soap php8.0-sqlite php8.0-xml php8.0-zip postgresql-client
      - name: Tag Image
        run: |
          docker tag gone/php:cli-8.0         docker.pkg.github.com/goneio/base-image/php:cli-8.0
          docker tag gone/php:cli-8.0-onbuild docker.pkg.github.com/goneio/base-image/php:cli-8.0-onbuild
      - name: Publish Image to Registries
        run: |
          docker push gone/php:cli-8.0
          docker push gone/php:cli-8.0-onbuild
          docker push docker.pkg.github.com/goneio/base-image/php:cli-8.0
          docker push docker.pkg.github.com/goneio/base-image/php:cli-8.0-onbuild

  VANITY_VERSIONS:
    runs-on: ubuntu-latest
    steps:
      - name: Login to registries
        run: |
          docker login -u ${{ secrets.DOCKER_HUB_USERNAME }} -p  ${{ secrets.DOCKER_HUB_PASSWORD }}
          docker login docker.pkg.github.com -u ${{ secrets.DOCKER_GITHUB_USERNAME }} -p  ${{ secrets.DOCKER_GITHUB_PASSWORD }}
      - name: Tag vanity versions
        run: |
          docker pull gone/php:apache-7.4
          docker tag gone/php:apache-7.4 gone/php:apache
          docker pull gone/php:cli-7.4
          docker tag gone/php:cli-7.4 gone/php:cli
          docker pull gone/php:nginx-7.4
          docker tag gone/php:nginx-7.4 gone/php:nginx
      - name: Push vanity versions
        run: |
          docker push gone/php:apache
          docker push gone/php:cli
          docker push gone/php:nginx


